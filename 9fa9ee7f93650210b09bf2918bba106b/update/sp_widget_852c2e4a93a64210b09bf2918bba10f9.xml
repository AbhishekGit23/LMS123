<?xml version="1.0" encoding="UTF-8"?><record_update table="sp_widget">
    <sp_widget action="INSERT_OR_UPDATE">
        <category>custom</category>
        <client_script><![CDATA[api.controller = function ($location, $scope) {
    var c = this;

    // Function to handle post question button click
    c.handlePostQuestion = function () {
        // Redirect the user to the page where they can post a question
        window.location.href = '?id=lms_question';
    };

    // Attach the handlePostQuestion function to the button click event
    document.getElementById('post-question-btn').addEventListener('click', c.handlePostQuestion);

    // Function to redirect to discussion detail page
    c.redirectToDiscussionDetail = function (sys_id) {
        var portalURL = $location.absUrl().split('?')[0];
        var pageID = 'lms_forum_answers';
        var url = portalURL + '?id=' + pageID +
                  '&sys_id=' + sys_id;
        window.location.href = url;
    };

    // Function to show all discussions
    c.showAllDiscussions = function () {
        c.filteredDiscussions = c.data.discussions;
    };

    // Call the function to show all discussions
    c.showAllDiscussions();
	  if (c.data.discussions && c.data.discussions.detailed_description) {
    c.data.discussions.detailed_description.value = $sce.trustAsHtml(c.data.discussions.detailed_description.value);
  }
};
]]></client_script>
        <controller_as>c</controller_as>
        <css>body {
  margin: 0;
  padding: 0;
  background-color: #e8f0fe;
  font-family: 'Poppins', sans-serif;
}

.forum-page {
  padding: 20px;
  max-width: 1200px;
  margin: 20px auto;
}

.forum-header {
  position: relative;
  text-align: center;
  margin-bottom: 40px;
  padding: 20px;
  background: linear-gradient(45deg, #6fb1fc, #4364f7);
  color: #fff;
  border-radius: 10px;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
  animation: slideIn 0.5s ease-in-out;
}

.forum-header h1 {
  font-size: 2.5em;
  margin-bottom: 10px;
}

.forum-header p {
  font-size: 1.2em;
}

.forum-content {
  gap: 20px; /* Removed display: flex */
}

.discussion-list {
  /* flex: 3; */ /* Remove this line */
}

.discussion-card {
  background: #fff;
  border-radius: 10px;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
  margin-bottom: 20px;
  padding: 20px;
  transition: transform 0.3s, box-shadow 0.3s;
  animation: fadeInUp 0.5s ease-in-out;
}

.discussion-card:hover {
  transform: translateY(-5px);
  box-shadow: 0 8px 16px rgba(0, 0, 0, 0.2);
}

.discussion-title {
  font-size: 1.8em;
  margin-bottom: 10px;
  color: #4364f7;
}

.discussion-excerpt {
  font-size: 1.2em;
  line-height: 1.4; /* Adjust line height as needed */
  color: #555;
  margin-bottom: 10px;
  max-height: 3.6em; /* Approximately two lines of text */
  overflow: hidden;
  display: -webkit-box;
  -webkit-line-clamp: 2; /* Limit to two lines */
  -webkit-box-orient: vertical;
}

.discussion-footer {
  display: flex;
  justify-content: space-between;
  font-size: 0.9em;
  color: #777;
}



#post-question-btn {
  position: absolute;
  top: 10px;
  right: 10px;
  background-color: #ffffff;
  color: #007bff;
  border: 0px;
  padding: 10px 20px;
  border-radius: 5px;
  cursor: pointer;
  font-size: 16px;
  transition: background-color 0.3s, color 0.3s;
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
}

#post-question-btn:hover {
  background-color: #0388fc;
  color: #ffffff;
}

/* Animations */
@keyframes slideIn {
  from {
    opacity: 0;
    transform: translateY(-100%);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

@keyframes fadeInUp {
  from {
    opacity: 0;
    transform: translateY(20px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

@keyframes fadeInRight {
  from {
    opacity: 0;
    transform: translateX(20px);
  }
  to {
    opacity: 1;
    transform: translateX(0);
  }
}
</css>
        <data_table>sp_instance</data_table>
        <demo_data/>
        <description/>
        <docs/>
        <field_list/>
        <has_preview>true</has_preview>
        <id>lms_discussion_forum</id>
        <internal>false</internal>
        <link><![CDATA[function link(scope, element, attrs, controller) {  }]]></link>
        <name>LMS Discussion Forum</name>
        <option_schema/>
        <public>true</public>
        <roles/>
        <script><![CDATA[(function () {
    data.discussions = [];
    
    var grDiscussion = new GlideRecord('x_1383177_lms_app_discussion');
    grDiscussion.query();

    while (grDiscussion.next()) {
        var questionBy = grDiscussion.getValue('question_by');
        var userName = '';

        // Fetch the user's name from sys_user table using the sys_id
        if (questionBy) {
            var grUser = new GlideRecord('sys_user');
            if (grUser.get(questionBy)) {
                userName = grUser.getValue('name');
            }
        }

        data.discussions.push({
            question: grDiscussion.getValue('question'),
            detailed_description: grDiscussion.getValue('detailed_description'),
            question_by: userName, // Use the fetched user name
            sys_id: grDiscussion.getUniqueValue()
        });
    }

    if (input) {
        // Handle user input if needed
    }
})();
]]></script>
        <servicenow>false</servicenow>
        <sys_class_name>sp_widget</sys_class_name>
        <sys_created_by>pranav.k</sys_created_by>
        <sys_created_on>2024-06-04 04:44:36</sys_created_on>
        <sys_id>852c2e4a93a64210b09bf2918bba10f9</sys_id>
        <sys_mod_count>60</sys_mod_count>
        <sys_name>LMS Discussion Forum</sys_name>
        <sys_package display_value="LMS Application" source="x_1383177_lms_app">9fa9ee7f93650210b09bf2918bba106b</sys_package>
        <sys_policy/>
        <sys_scope display_value="LMS Application">9fa9ee7f93650210b09bf2918bba106b</sys_scope>
        <sys_update_name>sp_widget_852c2e4a93a64210b09bf2918bba10f9</sys_update_name>
        <sys_updated_by>abhishek.s</sys_updated_by>
        <sys_updated_on>2024-06-11 10:26:01</sys_updated_on>
        <template><![CDATA[<div class="forum-page">
    <div class="forum-header">
        <h1>Discussion Forum</h1>
        <p>Engage in conversations, ask questions, and share knowledge with your peers.</p>
        <button id="post-question-btn">Post your Question</button>
    </div>

    <div class="forum-content">

<div class="discussion-card" ng-click="c.redirectToDiscussionDetail(disc.sys_id, disc.question, disc.detailed_description, disc.question_by)" ng-repeat="disc in c.filteredDiscussions | filter:{question:c.searchQuery}">
    <h2 class="discussion-title" ng-bind="disc.question"></h2>
    <p class="discussion-excerpt" ng-bind-html="disc.detailed_description"></p>
    <div class="discussion-footer">
        <span class="discussion-author">Posted by: <span ng-bind="disc.question_by"></span></span>
    </div>
</div>


        <!-- More discussion cards -->
    </div>
</div>
]]></template>
    </sp_widget>
</record_update>
